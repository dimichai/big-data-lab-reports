{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql.functions import lower, col\n\ndf = spark.read.json(\"s3://bigdatacourse2019/dblp-2019-02-01\")\\\n                .withColumn(\"title\",lower(col(\"title\")))\n                \ntags = spark.read.csv(\"s3://bigdatacourse2019/dblp_tags.txt\").withColumnRenamed(\"_c0\",\"tag\")\\\n            .withColumn(\"tag\",lower(col(\"tag\"))).cache()\ndf.show(2)\ntags.show(2)","user":"anonymous","dateUpdated":"2019-02-18T11:47:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+----+\n|             authors|                 doi|               title|year|\n+--------------------+--------------------+--------------------+----+\n|[N. A. Muhammad, ...|10.1007_s11277-01...|beam forming netw...|2012|\n|[Cuilian Li, Zhen...|10.1007_s11277-00...|a relaying incent...|2011|\n+--------------------+--------------------+--------------------+----+\nonly showing top 2 rows\n\n+--------------------+\n|                 tag|\n+--------------------+\n|           algorithm|\n|application progr...|\n+--------------------+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550484662478_193717529","id":"20190218-101102_582308791","dateCreated":"2019-02-18T10:11:02+0000","dateStarted":"2019-02-18T11:47:32+0000","dateFinished":"2019-02-18T11:48:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2432"},{"text":"%pyspark\ndf.printSchema()","user":"anonymous","dateUpdated":"2019-02-18T11:47:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- authors: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- doi: string (nullable = true)\n |-- title: string (nullable = true)\n |-- year: long (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1550484859891_-1427169935","id":"20190218-101419_900438301","dateCreated":"2019-02-18T10:14:19+0000","dateStarted":"2019-02-18T11:47:32+0000","dateFinished":"2019-02-18T11:48:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2433"},{"text":"%pyspark\nfrom pyspark.sql.functions import udf, col , explode\nfrom pyspark.sql.types import StringType, ArrayType\n\ntags_list = tags.select(\"tag\").rdd.flatMap(lambda x: x).collect()\n\nkeywords = sc.broadcast(set(tags_list))\n\ncontains = udf(\n    lambda s: list(set(s.split()) & keywords.value), \n    ArrayType(StringType()))\n    \nhas_tag = df.withColumn(\"tag\",explode(contains(col(\"title\")))).cache()","user":"anonymous","dateUpdated":"2019-02-18T11:47:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550485695898_-1490269876","id":"20190218-102815_670652280","dateCreated":"2019-02-18T10:28:15+0000","dateStarted":"2019-02-18T11:48:19+0000","dateFinished":"2019-02-18T11:48:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2434"},{"text":"%pyspark\nhas_tag.show()","user":"anonymous","dateUpdated":"2019-02-18T11:47:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+----+---------+\n|             authors|                 doi|               title|year|      tag|\n+--------------------+--------------------+--------------------+----+---------+\n|[Panagiotis G. Ba...|10.1023_A:1021155...|a maximum likelih...|2002|algorithm|\n|[Gwo-Jia Jong, Ar...|10.1007_s11277-01...|a novel queen hon...|2017|algorithm|\n|[Vinod Kumar Jain...|10.1007_s11277-01...|location estimati...|2012|embedding|\n|[Qiaofeng Meng, L...|10.1007_s11277-01...|research on multi...|2018|algorithm|\n|[Tripatjot Singh ...|10.1007_s11277-01...|a novel random tr...|2018|algorithm|\n|[Amardeo Sarma, J...|10.1007_s11277-00...|identities in the...|2009| internet|\n|[Marco A. Gonzale...|10.1007_s11277-00...|guide-gradient: a...|2011|algorithm|\n|[Chee Keong Tan, ...|10.1007_s11277-01...|a coalitional gam...|2015|algorithm|\n|[Ning Xie 0007, L...|10.1007_s11277-01...|an adaptive backo...|2015|algorithm|\n|[Ren-Ze Luo, Jiao...|10.1007_s11277-01...|synchronization a...|2016|algorithm|\n|[Changgeng Li, Zh...|10.1007_s11277-01...|an improved weigh...|2017|algorithm|\n|[S. Sridevi Sathy...|10.1007_s11277-01...|high throughput a...|2017|algorithm|\n|[Ali alhan, Celal...|10.1007_s11277-01...|an optimum vertic...|2012|algorithm|\n|[Ping Wang, Tho L...|10.1007_s11277-01...|a list sphere dec...|2011|algorithm|\n|[Manminder Singh,...|10.1007_s11277-01...|a novel face live...|2018|algorithm|\n|[Qi Wang, Qingsha...|10.1007_s11277-01...|an encoding algor...|2018|algorithm|\n|[Samreen Amir, Ad...|10.1007_s11277-01...|an innovative app...|2018|    virus|\n|[Sonia Goyal, Man...|10.1007_s11277-01...|modified bat algo...|2016|algorithm|\n|[L. Sharmila, U. ...|10.1007_s11277-01...|chronological pat...|2018|algorithm|\n|[Wei Zhao, Shouba...|10.1007_s11277-01...|improved dv-hop a...|2018|algorithm|\n+--------------------+--------------------+--------------------+----+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550486556863_1954056473","id":"20190218-104236_552458272","dateCreated":"2019-02-18T10:42:36+0000","dateStarted":"2019-02-18T11:48:19+0000","dateFinished":"2019-02-18T11:48:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2435"},{"text":"%pyspark\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.functions import rank\n\nwindow = Window.\\\n              partitionBy('tag')\\\n              .orderBy(df['year'].asc())\n              \nfirst_tag = has_tag.withColumn(\"rank\",rank().over(window))\\\n        .filter(\"rank == 1\")","user":"anonymous","dateUpdated":"2019-02-18T11:47:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550486839322_1697057887","id":"20190218-104719_1370609477","dateCreated":"2019-02-18T10:47:19+0000","dateStarted":"2019-02-18T11:48:20+0000","dateFinished":"2019-02-18T11:48:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2436"},{"text":"%pyspark\ndf_pd = first_tag.toPandas()","user":"anonymous","dateUpdated":"2019-02-18T11:54:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550488153928_751017229","id":"20190218-110913_1562364794","dateCreated":"2019-02-18T11:09:13+0000","dateStarted":"2019-02-18T11:54:27+0000","dateFinished":"2019-02-18T11:54:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2437"},{"text":"%pyspark\nfrom pyspark.sql.functions import concat_ws\n\nfirst_tag\\\n.withColumn(\"authors\",concat_ws(\", \",col(\"authors\")))\\\n.repartition(1).write.csv('s3://bd-group10/lab3/q2.csv')","user":"anonymous","dateUpdated":"2019-02-18T12:13:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550491496679_838316358","id":"20190218-120456_357682363","dateCreated":"2019-02-18T12:04:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3089","dateFinished":"2019-02-18T12:13:39+0000","dateStarted":"2019-02-18T12:13:37+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf_pd.to_csv(\"notebook/first_instance.csv\")","user":"anonymous","dateUpdated":"2019-02-18T11:59:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550488290017_475703938","id":"20190218-111130_1560099967","dateCreated":"2019-02-18T11:11:30+0000","dateStarted":"2019-02-18T11:59:17+0000","dateFinished":"2019-02-18T11:59:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2438"},{"text":"%sh\nls","user":"anonymous","dateUpdated":"2019-02-18T11:59:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"derby.log\nfirst_instance.csv\nlocal-repo\nmetastore_db\nnotebook\n"}]},"apps":[],"jobName":"paragraph_1550490872635_65066303","id":"20190218-115432_51960459","dateCreated":"2019-02-18T11:54:32+0000","dateStarted":"2019-02-18T11:59:03+0000","dateFinished":"2019-02-18T11:59:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2439"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-02-18T12:01:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550491302524_-1391763243","id":"20190218-120142_412997505","dateCreated":"2019-02-18T12:01:42+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3008"}],"name":"Q2","id":"2E4YZF87S","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}