{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql.functions import lower, col, concat, lit\n\ndf = spark.read.json(\"s3://bigdatacourse2019/dblp-2019-02-01\")\n                #.withColumnRenamed(\"title\",lower(col(\"title\")))\n                \ntags = spark.read.csv(\"s3://bigdatacourse2019/dblp_tags.txt\").withColumnRenamed(\"_c0\",\"tag\")\\\n            .withColumn(\"tag\",lower(col(\"tag\"))).cache()\n            \nbody = plaintext = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"false\").option(\"delimiter\", \",\").load(\"s3://papers-archive/batch2-txt-cs\").withColumnRenamed(\"_c0\", \"doi\").withColumnRenamed(\"_c1\", \"plaintext\")\n             \ndf = df.join(body,how=\"inner\",on=\"doi\")\ndf = df.withColumn(\"plaintext\",concat(col(\"title\"), lit(\" \"), col(\"plaintext\")))\\\n    .withColumn(\"plaintext\",lower(col(\"plaintext\")))\n    \ndf.show()\ntags.show(2)","dateUpdated":"2019-02-19T17:04:51+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+----+--------------------+\n|                 doi|             authors|               title|year|           plaintext|\n+--------------------+--------------------+--------------------+----+--------------------+\n|  10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|\n|   10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|\n|   10.1002_cae.10015|[J. M. Brtolo, Fe...|General purpose s...|2002|general purpose s...|\n|   10.1002_cae.20108|[Jing Guo, David ...|A chemical engine...|2007|a chemical engine...|\n|   10.1002_cae.20128|[Rosa Mara Aguila...|Teacher strategie...|2010|teacher strategie...|\n|   10.1002_cae.20333|[Dimosthenis E. B...|A teaching approa...|2011|a teaching approa...|\n|   10.1002_cae.20396|[A. Costa, M. Vil...|Matlab based simu...|2012|matlab based simu...|\n|     10.1002_cav.100|[Yunfan Bao, Xiao...|Physically based ...|2005|physically based ...|\n|    10.1002_cav.1570|[Nadia Magnenat-T...|Editorial Issue 2...|2014|editorial issue 2...|\n|    10.1002_cav.1579|[Ari Shapiro, And...|Rapid avatar capt...|2014|rapid avatar capt...|\n|    10.1002_cav.1599|[Liuyang Zhou, Li...|Human motion vari...|2014|human motion vari...|\n|      10.1002_cav.99|[Gazihan Alankus,...|Automated motion ...|2005|automated motion ...|\n|    10.1002_lnc3.358|[Jirka Hana, Anna...|Resource-Light Ap...|2012|resource-light ap...|\n|10.1002_malq.1982...|  [Mitsuru Yasuhara]|Cut Elimination i...|1982|cut elimination i...|\n|10.1002_malq.1987...|[Steve Giambrone,...|Proof Theories fo...|1987|proof theories fo...|\n|10.1002_malq.1989...|       [Martin Dowd]|An Extension of t...|1989|an extension of t...|\n|10.1002_malq.1991...|     [John C. Simms]|Covering Hyperspa...|1991|covering hyperspa...|\n|10.1002_malq.1992...|           [Qin Jun]|An Elementary Sys...|1992|an elementary sys...|\n|10.1002_malq.1994...|[Athanassios Tzou...|Omega- and Beta-M...|1994|omega- and beta-m...|\n|10.1002_malq.1995...| [Teresa Bigorajska]|On Sigma1-definab...|1995|on sigma1-definab...|\n+--------------------+--------------------+--------------------+----+--------------------+\nonly showing top 20 rows\n\n+--------------------+\n|                 tag|\n+--------------------+\n|           algorithm|\n|application progr...|\n+--------------------+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550590913871_-848527757","id":"20190218-101102_582308791","dateCreated":"2019-02-19T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1299","user":"anonymous","dateFinished":"2019-02-19T17:05:36+0000","dateStarted":"2019-02-19T17:04:52+0000"},{"text":"%pyspark\ndf.printSchema()","dateUpdated":"2019-02-19T15:45:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- authors: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- doi: string (nullable = true)\n |-- title: string (nullable = true)\n |-- year: long (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1550590913876_-839678532","id":"20190218-101419_900438301","dateCreated":"2019-02-19T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1300","user":"anonymous","dateFinished":"2019-02-19T15:46:09+0000","dateStarted":"2019-02-19T15:45:39+0000"},{"text":"%pyspark\nfrom pyspark.sql.functions import udf, col , explode\nfrom pyspark.sql.types import StringType, ArrayType\n\ntags_list = tags.select(\"tag\").rdd.flatMap(lambda x: x).collect()\n\nkeywords = sc.broadcast(set(tags_list))\n","dateUpdated":"2019-02-19T17:07:08+0000","config":{"lineNumbers":true,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550590913876_-839678532","id":"20190218-102815_670652280","dateCreated":"2019-02-19T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1301","user":"anonymous","dateFinished":"2019-02-19T17:07:08+0000","dateStarted":"2019-02-19T17:07:08+0000"},{"text":"%pyspark\n\ndef check_keywork(row):\n    output = []\n    \n    for x in keywords.value:\n        if x in row:\n            output.append(x)\n    \n    return output\n    \n    if len(output) == 0:\n        return None\n\ncontains = udf(lambda row: check_keywork(row), ArrayType(StringType()))\n    \nhas_tag = df.withColumn(\"tag\",explode(contains(col(\"plaintext\")))).cache()","user":"anonymous","dateUpdated":"2019-02-19T17:07:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550591530128_1401352471","id":"20190219-155210_854604508","dateCreated":"2019-02-19T15:52:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2677","dateFinished":"2019-02-19T17:07:19+0000","dateStarted":"2019-02-19T17:07:19+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nhas_tag.select(\"tag\").distinct().count()","dateUpdated":"2019-02-19T17:07:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"119\n"}]},"apps":[],"jobName":"paragraph_1550590913877_-840063281","id":"20190218-104236_552458272","dateCreated":"2019-02-19T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1303","user":"anonymous","dateFinished":"2019-02-19T17:11:53+0000","dateStarted":"2019-02-19T17:07:28+0000"},{"text":"%pyspark\nhas_tag.show()","user":"anonymous","dateUpdated":"2019-02-19T17:07:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550593169937_-1503569076","id":"20190219-161929_14673807","dateCreated":"2019-02-19T16:19:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4058","dateFinished":"2019-02-19T17:11:54+0000","dateStarted":"2019-02-19T17:07:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------------+--------------------+----+--------------------+--------------------+\n|               doi|             authors|               title|year|           plaintext|                 tag|\n+------------------+--------------------+--------------------+----+--------------------+--------------------+\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|      user interface|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|                 c++|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|            internet|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|         source code|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|                 nda|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|                http|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|                vlsi|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|                 erp|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|random access memory|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|           algorithm|\n|10.1002_bltj.21634|[Hans Sahm, Matth...|Optimized ASIC/FP...|2013|optimized asic/fp...|            database|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|   internet protocol|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|            internet|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|                 nda|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|                http|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|                 erp|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|application progr...|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|virtual private n...|\n| 10.1002_bltj.2260|[Patricia Streile...|Enabling revenue-...|2001|enabling revenue-...|           algorithm|\n| 10.1002_cae.10015|[J. M. Brtolo, Fe...|General purpose s...|2002|general purpose s...|             fortran|\n+------------------+--------------------+--------------------+----+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\nlen(keywords.value)","user":"anonymous","dateUpdated":"2019-02-19T17:12:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550592889150_-1112863407","id":"20190219-161449_323530459","dateCreated":"2019-02-19T16:14:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3840","dateFinished":"2019-02-19T17:12:14+0000","dateStarted":"2019-02-19T17:12:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"120\n"}]}},{"text":"%pyspark\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.functions import rank\n\nwindow = Window.\\\n              partitionBy('tag')\\\n              .orderBy(df['year'].asc())\n              \nfirst_tag = has_tag.withColumn(\"rank\",rank().over(window))\\\n        .filter(\"rank == 1\")","dateUpdated":"2019-02-19T17:12:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550590913878_-838909034","id":"20190218-104719_1370609477","dateCreated":"2019-02-19T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1304","user":"anonymous","dateFinished":"2019-02-19T17:12:37+0000","dateStarted":"2019-02-19T17:12:37+0000"},{"text":"%pyspark\nfrom pyspark.sql.functions import concat_ws\n\nfirst_tag\\\n.withColumn(\"authors\",concat_ws(\", \",col(\"authors\")))\\\n.select(\"tag\",\"year\",\"authors\",\"title\")\\\n.repartition(1)\\\n.write.csv('s3://bd-group10/lab3/q2.csv')","dateUpdated":"2019-02-19T17:23:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550590913880_-841217528","id":"20190218-120456_357682363","dateCreated":"2019-02-19T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1306","user":"anonymous","dateFinished":"2019-02-19T17:23:11+0000","dateStarted":"2019-02-19T17:23:00+0000"},{"text":"%pyspark\ndf.select(lower(col(\"title\")).alias(\"title\"),\"year\").filter(\"title like '% algorithm %'\").sort(col(\"year\").asc()).show()","user":"anonymous","dateUpdated":"2019-02-19T17:32:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550597153173_-883254278","id":"20190219-172553_1796228618","dateCreated":"2019-02-19T17:25:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4689","dateFinished":"2019-02-19T17:33:24+0000","dateStarted":"2019-02-19T17:32:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+\n|               title|year|\n+--------------------+----+\n|a tree systems in...|1988|\n|a linear parsing ...|1989|\n|simplifying algor...|1990|\n|an algorithm for ...|1991|\n|color and sound i...|1991|\n|an efficient adap...|1992|\n|a new two dimensi...|1992|\n|abstraction in al...|1992|\n|efficient image c...|1992|\n|a line clipping a...|1992|\n|aace - algorithm ...|1992|\n|integer de castel...|1992|\n|a run-length slic...|1992|\n|a progressive rad...|1993|\n|a rendering algor...|1993|\n|a new fault toler...|1993|\n|an all-integer al...|1994|\n|an algorithm for ...|1994|\n|an o(log n log lo...|1994|\n|a robust and cons...|1994|\n+--------------------+----+\nonly showing top 20 rows\n\n"}]}},{"text":"%sh\n","dateUpdated":"2019-02-19T17:18:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"derby.log\nfirst_instance.csv\nlocal-repo\nmetastore_db\nnotebook\n"}]},"apps":[],"jobName":"paragraph_1550590913882_-840448030","id":"20190218-115432_51960459","dateCreated":"2019-02-19T15:41:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1308"},{"text":"%pyspark\nkeywords.value","dateUpdated":"2019-02-19T16:24:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550590913882_-840448030","id":"20190218-120142_412997505","dateCreated":"2019-02-19T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1309","user":"anonymous","dateFinished":"2019-02-19T16:24:17+0000","dateStarted":"2019-02-19T16:24:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"set([u'lambda calculus', u'heuristics', u'chuck norris', u'nlp', u'entropy', u'pseudolanguage', u'concurrent version system', u'xml', u'loosely typed language', u'big data', u'deep web', u'reserved keyword', u'cross-platform', u'internet protocol', u'fortran', u'user interface', u'endianness', u'quantum computing', u'loophole', u'python', u'first-class object', u'ssl', u'compiler', u'c++', u'middleware', u'predictive analytics', u'text analytics', u'low-level language', u'linux', u'regular expression', u'batch processing', u'software development kit', u'internet', u'spoofing', u'functional programming', u'source code', u'distributed computing', u'hungarian notation', u'persistent memory', u'zombie', u'hashtable', u's-expression', u'search engine optimization', u'b-tree', u'web graph', u'nda', u'http', u'ocaml', u'pixel shader', u'embedding', u'honeypot', u'structured data', u'microservices', u'nested loop join', u'debugger', u'blockchain', u'data science', u'pseudocode', u'unix', u'segmentation fault', u'lookup trable', u'data mining', u'declarative programming', u'hello world', u'vlsi', u'spam', u'deep learning', u'machine language', u'bulk loading', u'devops', u'perl', u'json', u'integrated development environment', u'artificial intelligence', u'xpath', u'virtual machine', u'extensible markup language', u'fuzzy logic', u'general purpose language', u'erp', u'wormhole', u'lexical analysis', u'worm', u'machine learning', u'phishing', u'social graph', u'trojan horse', u'prolog', u'operator associativity', u'infrastructure as a service', u'parallel computing', u'shebang', u'packed memory array', u'ddos', u'pixels per inch', u'random access memory', u'common gateway interface', u'neural network', u'internet of things', u'malware', u'application programming interface', u'quicksort', u'natural language processing', u'genetic programming', u'procedural language', u'zero day', u'virtual private network', u'virus', u'decision tree', u'sql', u'garbage collector', u'relational algebra', u'polymorphism', u'algorithm', u'database', u'cloud computing', u'memoization', u'resource description framework', u'local optimum', u'relational database management system'])\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-02-19T16:24:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550593457316_-893916092","id":"20190219-162417_963105149","dateCreated":"2019-02-19T16:24:17+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4169"}],"name":"Q2","id":"2E3YDSANA","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}