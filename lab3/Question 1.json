{"paragraphs":[{"text":"%md\n# Part 1","user":"anonymous","dateUpdated":"2019-02-18T10:10:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Part 1</h1>\n"}]},"apps":[],"jobName":"paragraph_1550484288813_1824514874","id":"20190218-100448_1412355549","dateCreated":"2019-02-18T10:04:48+0000","dateStarted":"2019-02-18T10:10:18+0000","dateFinished":"2019-02-18T10:10:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3461"},{"text":"%pyspark\nfrom pyspark.sql.functions import lower, col, sum","user":"anonymous","dateUpdated":"2019-02-18T11:43:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550489297861_-1124044762","id":"20190218-112817_1915515442","dateCreated":"2019-02-18T11:28:17+0000","dateStarted":"2019-02-18T11:43:27+0000","dateFinished":"2019-02-18T11:43:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3462"},{"text":"%pyspark\nyeardoi = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"false\").option(\"delimiter\", \",\").load(\"s3://papers-archive/dblp/yeardoi\").withColumnRenamed(\"_c0\", \"year\").withColumnRenamed(\"_c1\", \"doi\").cache()","user":"anonymous","dateUpdated":"2019-02-18T11:24:01+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550484125172_-1171165253","id":"20190218-093756_298386055","dateCreated":"2019-02-18T10:02:05+0000","dateStarted":"2019-02-18T11:24:01+0000","dateFinished":"2019-02-18T11:25:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3463"},{"text":"%pyspark\nplaintext = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"false\").option(\"delimiter\", \",\").load(\"s3://papers-archive/batch2-txt-cs\").withColumnRenamed(\"_c0\", \"doi\").withColumnRenamed(\"_c1\", \"plaintext\")\n","user":"anonymous","dateUpdated":"2019-02-18T11:24:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550484125179_-1172319500","id":"20190218-093811_769784812","dateCreated":"2019-02-18T10:02:05+0000","dateStarted":"2019-02-18T11:24:05+0000","dateFinished":"2019-02-18T11:25:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3464"},{"text":"%pyspark\nyeardoi.show(10)\nyeardoi.count()","user":"anonymous","dateUpdated":"2019-02-18T11:25:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+--------------------+\n|year|                 doi|\n+----+--------------------+\n|1996|  10.1007_BF03036466|\n|1983|  10.1007_BF01257084|\n|1983|  10.1007_BF00289414|\n|1982|  10.1007_BF00264161|\n|1977|  10.1007_BF00289470|\n|2011|10.1007_s00236-01...|\n|1987|  10.1007_BF00282618|\n|1988|  10.1007_BF00268843|\n|1978|  10.1007_BF00264322|\n|2012|10.1007_s00236-01...|\n+----+--------------------+\nonly showing top 10 rows\n\n3872091\n"}]},"apps":[],"jobName":"paragraph_1550484125180_-1174243244","id":"20190218-093921_508703609","dateCreated":"2019-02-18T10:02:05+0000","dateStarted":"2019-02-18T11:25:31+0000","dateFinished":"2019-02-18T11:25:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3465"},{"text":"%pyspark\nplaintext.show(10)\nplaintext.count()","user":"anonymous","dateUpdated":"2019-02-18T11:26:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------------+\n|               doi|           plaintext|\n+------------------+--------------------+\n|   10.1002_bltj.16|The Need for Thir...|\n|10.1002_bltj.20366|◆ Design and Corr...|\n|10.1002_bltj.20531|◆ Subjective Vide...|\n|10.1002_bltj.21636|Bell Labs Technic...|\n| 10.1002_cae.20191|SIMPERF: SIMULINK...|\n| 10.1002_cae.20230|A Versatile Softw...|\n| 10.1002_cae.20515|More Carrot Than ...|\n| 10.1002_cae.20533|Study of the Sepa...|\n| 10.1002_cae.20577|FATSIM-A: An Educ...|\n|   10.1002_cav.253|COMPUTER ANIMATIO...|\n+------------------+--------------------+\nonly showing top 10 rows\n\n96426\n"}]},"apps":[],"jobName":"paragraph_1550484125180_-1174243244","id":"20190218-094918_1909687118","dateCreated":"2019-02-18T10:02:05+0000","dateStarted":"2019-02-18T11:26:00+0000","dateFinished":"2019-02-18T11:26:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3466"},{"text":"%pyspark\ndf_papers = plaintext.join(yeardoi, how=\"inner\", on=\"doi\")\n# Convert 'plaintext' to lower case\ndf_papers = df_papers.withColumn(\"plaintext\",lower(col(\"plaintext\")))","user":"anonymous","dateUpdated":"2019-02-18T11:36:22+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550484125181_-1174627993","id":"20190218-094932_1807243710","dateCreated":"2019-02-18T10:02:05+0000","dateStarted":"2019-02-18T11:36:22+0000","dateFinished":"2019-02-18T11:36:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3467"},{"text":"%pyspark\ndf_papers.show(5)\ndf_papers.count()","user":"anonymous","dateUpdated":"2019-02-18T11:36:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------------+----+\n|               doi|           plaintext|year|\n+------------------+--------------------+----+\n|10.1002_bltj.21634|bell labs technic...|2013|\n| 10.1002_bltj.2260|bell labs technic...|2001|\n| 10.1002_cae.10015|general purposeso...|2002|\n| 10.1002_cae.20108|a chemical engine...|2007|\n| 10.1002_cae.20128|teacher strategie...|2010|\n+------------------+--------------------+----+\nonly showing top 5 rows\n\n96426\n"}]},"apps":[],"jobName":"paragraph_1550484125186_-1482811862","id":"20190218-095609_749077233","dateCreated":"2019-02-18T10:02:05+0000","dateStarted":"2019-02-18T11:36:25+0000","dateFinished":"2019-02-18T11:37:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3468"},{"text":"%pyspark\nsearch = [\"sql\", \"rdf\", \"xml\", \"nosql\", \"machine learning\", \"hadoop\", \"internet of things\", \"data science\", \"blockchain\"]\n\ndf_papers = df_papers.withColumn('sql', col('plaintext').like('% sql %'))\ndf_papers = df_papers.withColumn('rdf', col('plaintext').like('% rdf %'))","user":"anonymous","dateUpdated":"2019-02-18T11:37:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550485568719_1064261962","id":"20190218-102608_1435494479","dateCreated":"2019-02-18T10:26:08+0000","dateStarted":"2019-02-18T11:37:01+0000","dateFinished":"2019-02-18T11:37:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3469"},{"text":"%pyspark\ndf_papers.show(5)","user":"anonymous","dateUpdated":"2019-02-18T11:32:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------------+----+-----+-----+\n|               doi|           plaintext|year|  sql|  rdf|\n+------------------+--------------------+----+-----+-----+\n|10.1002_bltj.21634|Bell Labs Technic...|2013|false|false|\n| 10.1002_bltj.2260|Bell Labs Technic...|2001|false|false|\n| 10.1002_cae.10015|General PurposeSo...|2002|false|false|\n| 10.1002_cae.20108|A Chemical Engine...|2007|false|false|\n| 10.1002_cae.20128|Teacher Strategie...|2010|false|false|\n+------------------+--------------------+----+-----+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1550485418089_398648009","id":"20190218-102338_503528619","dateCreated":"2019-02-18T10:23:38+0000","dateStarted":"2019-02-18T11:32:57+0000","dateFinished":"2019-02-18T11:33:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3470"},{"text":"%pyspark\ndf_papers.groupBy('year').agg(sum(col('sql').cast('long')), sum(col('rdf').cast('long'))).collect()\n# df_papers.groupBy('year').count().collect()","user":"anonymous","dateUpdated":"2019-02-18T11:47:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(year=u'7', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1987', sum(CAST(sql AS BIGINT))=1, sum(CAST(rdf AS BIGINT))=0), Row(year=u'15', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2016', sum(CAST(sql AS BIGINT))=9, sum(CAST(rdf AS BIGINT))=15), Row(year=u'2012', sum(CAST(sql AS BIGINT))=339, sum(CAST(rdf AS BIGINT))=161), Row(year=u'1988', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2017', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=2), Row(year=u'8', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1977', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2014', sum(CAST(sql AS BIGINT))=71, sum(CAST(rdf AS BIGINT))=32), Row(year=u'1984', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2013', sum(CAST(sql AS BIGINT))=160, sum(CAST(rdf AS BIGINT))=246), Row(year=u'1982', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2005', sum(CAST(sql AS BIGINT))=45, sum(CAST(rdf AS BIGINT))=12), Row(year=u'2000', sum(CAST(sql AS BIGINT))=10, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1981', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1978', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2002', sum(CAST(sql AS BIGINT))=16, sum(CAST(rdf AS BIGINT))=3), Row(year=u'2009', sum(CAST(sql AS BIGINT))=225, sum(CAST(rdf AS BIGINT))=137), Row(year=u'1995', sum(CAST(sql AS BIGINT))=1, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2006', sum(CAST(sql AS BIGINT))=40, sum(CAST(rdf AS BIGINT))=7), Row(year=u'1976', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2004', sum(CAST(sql AS BIGINT))=24, sum(CAST(rdf AS BIGINT))=1), Row(year=u'2011', sum(CAST(sql AS BIGINT))=317, sum(CAST(rdf AS BIGINT))=259), Row(year=u'1989', sum(CAST(sql AS BIGINT))=1, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1992', sum(CAST(sql AS BIGINT))=3, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2008', sum(CAST(sql AS BIGINT))=178, sum(CAST(rdf AS BIGINT))=92), Row(year=u'1999', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1994', sum(CAST(sql AS BIGINT))=2, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1997', sum(CAST(sql AS BIGINT))=2, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2007', sum(CAST(sql AS BIGINT))=55, sum(CAST(rdf AS BIGINT))=8), Row(year=u'1996', sum(CAST(sql AS BIGINT))=1, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1983', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1980', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1986', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1985', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1979', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2015', sum(CAST(sql AS BIGINT))=54, sum(CAST(rdf AS BIGINT))=29), Row(year=u'1998', sum(CAST(sql AS BIGINT))=1, sum(CAST(rdf AS BIGINT))=0), Row(year=u'4', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1993', sum(CAST(sql AS BIGINT))=3, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2001', sum(CAST(sql AS BIGINT))=4, sum(CAST(rdf AS BIGINT))=0), Row(year=u'13', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2010', sum(CAST(sql AS BIGINT))=192, sum(CAST(rdf AS BIGINT))=189), Row(year=u'1990', sum(CAST(sql AS BIGINT))=3, sum(CAST(rdf AS BIGINT))=0), Row(year=u'1991', sum(CAST(sql AS BIGINT))=1, sum(CAST(rdf AS BIGINT))=0), Row(year=u'2003', sum(CAST(sql AS BIGINT))=18, sum(CAST(rdf AS BIGINT))=1), Row(year=u'1975', sum(CAST(sql AS BIGINT))=0, sum(CAST(rdf AS BIGINT))=0)]\n"}]},"apps":[],"jobName":"paragraph_1550486341984_567281875","id":"20190218-103901_681159025","dateCreated":"2019-02-18T10:39:01+0000","dateStarted":"2019-02-18T11:47:12+0000","dateFinished":"2019-02-18T11:48:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3471"},{"text":"%pyspark\ndf_papers.take(1)","user":"anonymous","dateUpdated":"2019-02-18T11:19:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-3355161036979094469.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-3355161036979094469.py\", line 360, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/spark/python/pyspark/sql/dataframe.py\", line 476, in take\n    return self.limit(num).collect()\n  File \"/usr/lib/spark/python/pyspark/sql/dataframe.py\", line 438, in collect\n    port = self._jdf.collectToPython()\n  File \"/usr/lib/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py\", line 1133, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/lib/spark/python/pyspark/sql/utils.py\", line 67, in deco\n    e.java_exception.getStackTrace()))\n  File \"/usr/lib/spark/python/pyspark/sql/utils.py\", line 66, in <lambda>\n    stackTrace = '\\n\\t at '.join(map(lambda x: x.toString(),\n  File \"/usr/lib/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py\", line 1131, in __call__\n    answer = self.gateway_client.send_command(command)\n  File \"/usr/lib/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py\", line 883, in send_command\n    response = connection.send_command(command)\n  File \"/usr/lib/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py\", line 1028, in send_command\n    answer = smart_decode(self.stream.readline()[:-1])\n  File \"/usr/lib64/python2.7/socket.py\", line 451, in readline\n    data = self._sock.recv(self._rbufsize)\n  File \"/usr/lib/spark/python/pyspark/context.py\", line 237, in signal_handler\n    raise KeyboardInterrupt()\nKeyboardInterrupt\n\n"}]},"apps":[],"jobName":"paragraph_1550486607683_-1298397834","id":"20190218-104327_1915183808","dateCreated":"2019-02-18T10:43:27+0000","dateStarted":"2019-02-18T11:18:57+0000","dateFinished":"2019-02-18T11:20:33+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3472"},{"text":"%pyspark\ndf_papers.count()","user":"anonymous","dateUpdated":"2019-02-18T11:19:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550488737473_-494038958","id":"20190218-111857_570082210","dateCreated":"2019-02-18T11:18:57+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3473"}],"name":"Question 1","id":"2E5XSVNQJ","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}